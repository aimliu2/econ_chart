<!-- load then execute -->
<div id="template">
<div class="container col-xl-10 col-xxl-8 px-4 py-5">
    <div class="row">
        <div id="tableContent"></div>
    </div> <!-- end row -->
</div> <!-- end container -->
</div> <!-- end template -->

<script>
// import {getLink,listDir} from './libs/mjs/modules.mjs'

// external var
const root = "https://ido-aim.github.io/"

// load external css
let cssUrl = "https://cdn.jsdelivr.net/npm/gridjs/dist/theme/mermaid.min.css"
$.get(cssUrl , function(){                    
    $('<link>', {rel:'stylesheet', type:'text/css', 'href':cssUrl}).appendTo('header');
});
// load external js
let jsUrl = "https://cdn.jsdelivr.net/npm/gridjs/dist/gridjs.umd.js"
$.get(jsUrl , function(){                    
    $('<script>', {type:'text/javascript', 'src':jsUrl}).appendTo('header');
});

// external function
function getLink(repo,folder,subfolder){
    // example  https://ido-aim.github.io/paper/dist/25_FEB_2022:Start/
    let url =  `${root}${repo}/${folder}/${subfolder}/`
    return url
}

async function listDir(user, repo, directory) {
  let url = `https://api.github.com/repos/${user}/${repo}/git/trees/main`;
  let list = await fetch(url).then(res => res.json());
  let dir = list.tree.find(node => node.path === directory);
  if (dir) {
     const list = await fetch(dir.url).then(res => res.json());
     return list.tree.map(node => node.path);
  }
}  
// execute
// module.mjs
listDir("ido-aim", "paper", "dist").then(res => {
    let dat = [];
    // looping through response
    for(let sfolder in res){
        // create response object
        let fullLink = getLink("paper","dist",res[sfolder])
        let topicName = res[sfolder].split(":")[1]
        let linkName = res[sfolder]
        dat.push({"Topics":topicName,"Links":fullLink,"linkName":linkName})
    }
    console.log(dat)
})
// init grid.js

//     new gridjs.Grid({
//     columns: ['Name', 'Email', 'Phone Number'],
//     data: [
//         ['John', 'john@example.com', '(353) 01 222 3333'],
//         ['Mark', 'mark@gmail.com',   '(01) 22 888 4444']
//     ]
//     }).render(document.getElementById("tableContent"));

</script>